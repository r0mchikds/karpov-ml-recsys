# üß† –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (TF-IDF –∏ BERT)

**–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ [¬´–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ¬ª –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Karpov.Courses](https://karpov.courses/ml-engineer)**
–ó–∞–¥–∞—á–∞ ‚Äî –æ–±—É—á–∏—Ç—å –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–µ –º–æ–¥–µ–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:  
–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ (TF-IDF) –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ (BERT-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏).

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –æ—Ü–µ–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É –¥–≤—É—Ö –º–æ–¥–µ–ª–µ–π –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (CatBoost),  
–ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â–∏—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ª–∞–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –ø–æ—Å—Ç—É,  
–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ç–µ–∫—Å—Ç–æ–≤:

- **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å** ‚Äî TF-IDF + PCA  
- **–¢–µ—Å—Ç–æ–≤–∞—è –º–æ–¥–µ–ª—å** ‚Äî DistilBERT + PCA  

–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–º API —Å A/B-—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|------------|-------------|
| **–Ø–∑—ã–∫ / –≤–µ—Ä—Å–∏—è** | Python 3.12.7 |
| **ML / NLP** | CatBoost ¬∑ scikit-learn ¬∑ transformers (DistilBERT) |
| **Data** | Pandas ¬∑ NumPy |
| **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** | FastAPI ¬∑ PostgreSQL |
| **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** | Matplotlib ¬∑ Seaborn |
| **–£—Ç–∏–ª–∏—Ç—ã** | tqdm |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ app.py                                 # FastAPI-—Å–µ—Ä–≤–∏—Å —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
‚îú‚îÄ‚îÄ schema.py                              # Pydantic-—Å—Ö–µ–º—ã –¥–ª—è API-–æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ 01_data_exploration.ipynb              # –ù–æ—É—Ç–±—É–∫ —Å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ 02_post_embeddings_distilbert.ipynb    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ BERT-—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îú‚îÄ‚îÄ 03_feature_generation.ipynb            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∏—á–µ–π
‚îú‚îÄ‚îÄ 04_model_training.ipynb                # –ù–æ—É—Ç–±—É–∫ –æ–±—É—á–µ–Ω–∏—è CatBoost-–º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ requirements.txt                       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md                              # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```

---

## üß© –ö–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**  
   - –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤ –ø–æ—Å—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π;
   - –æ—á–∏—Å—Ç–∫–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

2. **–°–æ–∑–¥–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤**  
   - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `DistilBERT` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∫—Ä—ã—Ç—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ç–µ–∫—Å—Ç–æ–≤;  
   - —Å–∂–∞—Ç–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é `PCA (n_components=20)`.

3. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**  
   - –æ–±—É—á–µ–Ω–∏–µ `CatBoostClassifier` –Ω–∞ TF-IDF –∏ BERT —Ñ–∏—á–∞—Ö;  
   - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –≤ `.cbm`-—Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ API.

4. **A/B-—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**  
   - —Ñ—É–Ω–∫—Ü–∏—è `get_exp_group()` –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≥—Ä—É–ø–ø—É `"control"` –∏–ª–∏ `"test"`  
     –Ω–∞ –æ—Å–Ω–æ–≤–µ MD5-—Ö–µ—à–∞ —Å —Å–æ–ª—å—é (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ).

5. **FastAPI-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å**  
   - —ç–Ω–¥–ø–æ–∏–Ω—Ç `/post/recommendations/` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ø-N –ø–æ—Å—Ç–æ–≤;  
   - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É–∂–µ –ª–∞–π–∫–Ω—É—Ç—ã—Ö –ø–æ—Å—Ç–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –ø–æ Pydantic-—Å—Ö–µ–º–µ.

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è

| –ú–æ–¥–µ–ª—å | Train ROC-AUC | Test ROC-AUC |
|--------|----------------|--------------|
| TF-IDF (–∫–æ–Ω—Ç—Ä–æ–ª—å) | 0.6896 | 0.6426 |
| BERT (—Ç–µ—Å—Ç) | 0.6957 | 0.6583 |

> –†–∞–∑–Ω–∏—Ü–∞ –≤ –º–µ—Ç—Ä–∏–∫–µ ROC-AUC –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.  
> –û–¥–Ω–∞–∫–æ –≤ –æ–Ω–ª–∞–π–Ω-—Ç–µ—Å—Ç–∞—Ö —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ü–µ–ª—å—é –æ—Å—Ç–∞—ë—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∞ **HitRate@5**.

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ

1. –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

   ```bash
   python3.12 -m venv .venv
   source .venv/bin/activate
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

    ```bash
    pip install -r requirements.txt
    ```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API:
    ```bash
    uvicorn app:app --host 0.0.0.0 --port 8080
    ```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
    http://localhost:8080/docs

---

## üß† –ö—Ä–∞—Ç–∫–æ –æ –ª–æ–≥–∏–∫–µ API

* **A/B-–ª–æ–≥–∏–∫–∞**:
  –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–ª—è—Ç—Å—è –ø–æ `user_id` –Ω–∞ `"control"` –∏ `"test"` –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ md5-—Ö–µ—à.

* **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞** -> –º–æ–¥–µ–ª—å `model_control.cbm` (TF-IDF)

* **–¢–µ—Å—Ç–æ–≤–∞—è –≥—Ä—É–ø–ø–∞** -> –º–æ–¥–µ–ª—å `model_test.cbm` (BERT)

* **–≠–Ω–¥–ø–æ–∏–Ω—Ç** `/post/recommendations/` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON-–æ—Ç–≤–µ—Ç –≤–∏–¥–∞:

  ```json
  {
    "exp_group": "test",
    "recommendations": [
      {"id": 1, "text": "...", "topic": "business"},
      {"id": 2, "text": "...", "topic": "tech"}
    ]
  }
  ```

---

## ‚úÖ –ò—Ç–æ–≥–∏

* –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ TF-IDF –∏ BERT-–ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–º —Ñ–∏—á–∞–º
* –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –æ–±–µ –º–æ–¥–µ–ª–∏ CatBoost
* –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ FastAPI –¥–ª—è –æ–Ω–ª–∞–π–Ω-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
* –ü—Ä–æ–µ–∫—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –≤–µ—Ä—Å–∏–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã)

---

## üì¨ –ê–≤—Ç–æ—Ä

**–†–æ–º–∞–Ω –¢–∏—Ö–æ–Ω–æ–≤**
üìß **Email:** [tikhonovrs96@mail.ru](mailto:tikhonovrs96@mail.ru)  
üí¨ **Telegram:** [@tinovokh](https://t.me/tinovokh)  
üåê **GitHub:** [r0mchikds](https://github.com/r0mchikds)  
